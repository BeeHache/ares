<div *ngIf="loading">Loading feed data...</div>
<div *ngIf="error" style="color: red">{{ error }}</div>

<div class="feed-items-container" *ngIf="feed; else noFeed">
  <div class="feed-header">
    <div class="header-top">
        <h3>{{ feed.title }}</h3>
        <button class="unsubscribe-btn" (click)="deleteFeed()">Unsubscribe</button>
    </div>
    <p class="feed-description" *ngIf="feed.description" [innerHTML]="feed.description"></p>
    <a [href]="feed.link" target="_blank" class="feed-source-link">Visit Website</a>
  </div>

  <div class="items-list">
    <div *ngFor="let item of items" class="item-card">
      <h4><a [href]="item.link" target="_blank">{{ item.title }}</a></h4>
      <div class="item-meta">
        <span *ngIf="item.date">{{ item.date | date:'medium' }}</span>
      </div>

      <!-- Enclosures (Audio/Video Player) -->
      <div *ngIf="item.enclosures && item.enclosures.length > 0" class="enclosures">
        <div *ngFor="let enclosure of item.enclosures">

          <!-- Audio Player -->
          <div *ngIf="enclosure.type?.startsWith('audio/')" class="audio-player">
            <audio controls preload="none">
              <source [src]="enclosure.url" [type]="enclosure.type">
              Your browser does not support the audio element.
            </audio>
          </div>

          <!-- Video Player -->
          <div *ngIf="enclosure.type?.startsWith('video/')" class="video-player">
            <video controls preload="none" style="max-width: 100%; height: auto;">
              <source [src]="enclosure.url" [type]="enclosure.type">
              Your browser does not support the video element.
            </video>
          </div>

          <!-- Download Link (for other types) -->
          <div *ngIf="!enclosure.type?.startsWith('audio/') && !enclosure.type?.startsWith('video/')" class="file-download">
             <a [href]="enclosure.url" target="_blank">Download {{ enclosure.type }}</a>
          </div>

        </div>
      </div>

      <p class="item-description" *ngIf="item.description" [innerHTML]="item.description"></p>
    </div>

    <div *ngIf="items.length === 0" class="no-items">
        <p>No items found in this feed.</p>
    </div>
  </div>
</div>

<ng-template #noFeed>
  <div class="placeholder">
    <p>Select a feed from the list to view its articles.</p>
  </div>
</ng-template>
